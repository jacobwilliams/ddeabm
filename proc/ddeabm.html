<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Modern Fortran Implementation of the DDEABM Adams-Bashforth-Moulton ODE Solver">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>ddeabm &ndash; ddeabm</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ddeabm </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
				
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
		 aria-expanded="false">Contents <span class="caret"></span></a>
	      <ul class="dropdown-menu">
              
            <li><a href="../lists/files.html">Source Files</a></li>
				
				
            <li><a href="../lists/modules.html">Modules</a></li>
				
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
				
				
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
								
            <li><a href="../lists/types.html">Derived Types</a></li>
				
				
            </ul>
            </li>

<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>ddeabm
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
	  data-placement="bottom" data-html="true"
	  title=" 2.1% of total for procedures.">33 statements</a>
     </li> 
     
     
    <li><i class="fa fa-code"></i><a href="../src/ddeabm_module.f90"> Source File</a></li>
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
     <li><a href='../sourcefile/ddeabm_module.f90.html'>ddeabm_module.f90</a></li>
  
     <li><a href='../module/ddeabm_module.html'>ddeabm_module</a></li>
  
     <li class="active">ddeabm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ddeabm.html#src">ddeabm</a>
  </div>
</div>


  <hr>
  

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-0">All Procedures</a></h3></div>
  <div id="allprocs-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/ddeabm.html">ddeabm</a>
      
      <a class="list-group-item" href="../proc/ddeabm_initialize.html">ddeabm_initialize</a>
      
      <a class="list-group-item" href="../proc/ddeabm_interp.html">ddeabm_interp</a>
      
      <a class="list-group-item" href="../proc/ddeabm_new_problem.html">ddeabm_new_problem</a>
      
      <a class="list-group-item" href="../proc/ddeabm_stop_integration.html">ddeabm_stop_integration</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_initialize.html">ddeabm_with_event_initialize</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_initialize_vec.html">ddeabm_with_event_initialize_vec</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_wrapper.html">ddeabm_with_event_wrapper</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_wrapper_vec.html">ddeabm_with_event_wrapper_vec</a>
      
      <a class="list-group-item" href="../proc/ddeabm_wrapper.html">ddeabm_wrapper</a>
      
      <a class="list-group-item" href="../proc/ddes.html">ddes</a>
      
      <a class="list-group-item" href="../proc/destroy_ddeabm.html">destroy_ddeabm</a>
      
      <a class="list-group-item" href="../proc/dhstrt.html">dhstrt</a>
      
      <a class="list-group-item" href="../proc/dhvnrm.html">dhvnrm</a>
      
      <a class="list-group-item" href="../proc/dintp.html">dintp</a>
      
      <a class="list-group-item" href="../proc/dsteps.html">dsteps</a>
      
      <a class="list-group-item" href="../proc/report_error.html">report_error</a>
      
      <a class="list-group-item" href="../proc/zeroin.html">zeroin</a>
      
    </div>
  </div>
</div>


</div>  

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
private subroutine ddeabm(me, neq, t, y, tout, info, rtol, atol, idid)
    
    
	 
</h2>
    
  


    
    <p>solve an initial value problem in ordinary differential
  equations using an adams-bashforth method.</p>
<p>subroutine ddeabm uses the adams-bashforth-moulton
  predictor-corrector formulas of orders one through twelve to
  integrate a system of neq first order ordinary differential
  equations of the form <code>du/dx = df(x,u)</code>
  when the vector <code>y(*)</code> of initial values for <code>u(*)</code> at <code>x=t</code> is given.
  the subroutine integrates from <code>t</code> to <code>tout</code>. it is easy to continue the
  integration to get results at additional <code>tout</code>.  this is the interval
  mode of operation.  it is also easy for the routine to return with
  the solution at each intermediate step on the way to <code>tout</code>.  this is
  the intermediate-output mode of operation.</p>
<p>ddeabm is primarily designed to solve non-stiff and
  mildly stiff differential equations when derivative evaluations
  are expensive, high accuracy results are needed or answers at
  many specific points are required. ddeabm attempts to discover
  when it is not suitable for the task posed.</p>
<p><strong>quantities which are used as input items are:</strong>
    <code>neq, t, y(*), tout, info(*), rtol, atol</code></p>
<p><strong>quantities which may be altered by the code are:</strong>
    <code>t, y(*), info(1), rtol, atol, idid</code></p>
<h3>Description of the arguments to ddeabm (an overview)</h3>
<p>the parameters are</p>
<div class="codehilite"><pre><span></span>  df -- this is the name of a subroutine which you provide to
         define the differential equations.

  neq -- this is the number of (first order) differential
         equations to be integrated.

  t -- this is a double precision value of the independent
       variable.

  y(*) -- this double precision array contains the solution
          components at t.

  tout -- this is a double precision point at which a solution is
          desired.

  info(*) -- the basic task of the code is to integrate the
         differential equations from t to tout and return an
         answer at tout.  info(*) is an integer array which is used
         to communicate exactly how you want this task to be
         carried out.

  rtol, atol -- these double precision quantities represent
                relative and absolute error tolerances which you
                provide to indicate how accurately you wish the
                solution to be computed.  you may choose them to be
                both scalars or else both vectors.

  idid -- this scalar quantity is an indicator reporting what
         the code did.  you must monitor this integer variable to
         decide what action to take next.
</pre></div>


<h3>input -- what to do on the first call to ddeabm</h3>
<p>the first call of the code is defined to be the start of each new
   problem.  read through the descriptions of all the following items,
   provide sufficient storage space for designated arrays, set
   appropriate variables for the initialization of the problem, and
   give information about how you want the problem to be solved.</p>
<div class="codehilite"><pre><span></span>  df -- provide a subroutine of the form
                           df(x,u,uprime)
         to define the system of first order differential equations
         which is to be solved.  for the given values of x and the
         vector u(*)=(u(1),u(2),...,u(neq)), the subroutine must
         evaluate the neq components of the system of differential
         equations du/dx=df(x,u) and store the derivatives in the
         array uprime(*), that is, uprime(i) = du(i)/dx for
         equations i=1,...,neq.

         subroutine df must not alter x or u(*).  you must declare
         the name df in an external statement in your program that
         calls ddeabm.  you must dimension u and uprime in df.

  neq -- set it to the number of differential equations.
         (neq &gt;= 1)

  t -- set it to the initial point of the integration.
         you must use a program variable for t because the code
         changes its value.

  y(*) -- set this vector to the initial values of the neq solution
         components at the initial point.  you must dimension y at
         least neq in your calling program.

  tout -- set it to the first point at which a solution
         is desired.  you can take tout = t, in which case the code
         will evaluate the derivative of the solution at t and
         return. integration either forward in t (tout &gt; t) or
         backward in t (tout &lt; t) is permitted.

         the code advances the solution from t to tout using
         step sizes which are automatically selected so as to
         achieve the desired accuracy.  if you wish, the code will
         return with the solution and its derivative following
         each intermediate step (intermediate-output mode) so that
         you can monitor them, but you still must provide tout in
         accord with the basic aim of the code.

         the first step taken by the code is a critical one
         because it must reflect how fast the solution changes near
         the initial point.  the code automatically selects an
         initial step size which is practically always suitable for
         the problem. by using the fact that the code will not step
         past tout in the first step, you could, if necessary,
         restrict the length of the initial step size.

         for some problems it may not be permissible to integrate
         past a point tstop because a discontinuity occurs there
         or the solution or its derivative is not defined beyond
         tstop.  when you have declared a tstop point (see info(4)),
         you have told the code not to integrate past tstop.
         in this case any tout beyond tstop is invalid input.

  info(*) -- use the info array to give the code more details about
         how you want your problem solved.  this array should be
         dimensioned of length 4.  you must respond to all of
         the following items which are arranged as questions.  the
         simplest use of the code corresponds to answering all
         questions as yes ,i.e. setting all entries of info to 0.

    info(1) -- this parameter enables the code to initialize
           itself.  you must set it to indicate the start of every
           new problem.

        **** is this the first call for this problem ...
              yes -- set info(1) = 0
               no -- not applicable here.
                     see below for continuation calls.  ****

    info(2) -- how much accuracy you want of your solution
           is specified by the error tolerances rtol and atol.
           the simplest use is to take them both to be scalars.
           to obtain more flexibility, they can both be vectors.
           the code must be told your choice.

        **** are both error tolerances rtol, atol scalars ...
              yes -- set info(2) = 0
                     and input scalars for both rtol and atol
               no -- set info(2) = 1
                     and input arrays for both rtol and atol ****

    info(3) -- the code integrates from t in the direction
           of tout by steps.  if you wish, it will return the
           computed solution and derivative at the next
           intermediate step (the intermediate-output mode) or
           tout, whichever comes first.  this is a good way to
           proceed if you want to see the behavior of the solution.
           if you must have solutions at a great many specific
           tout points, this code will compute them efficiently.

        **** do you want the solution only at
             tout (and not at the next intermediate step) ...
              yes -- set info(3) = 0
               no -- set info(3) = 1 ****

    info(4) -- to handle solutions at a great many specific
           values tout efficiently, this code may integrate past
           tout and interpolate to obtain the result at tout.
           sometimes it is not possible to integrate beyond some
           point tstop because the equation changes there or it is
           not defined past tstop.  then you must tell the code
           not to go past.

        **** can the integration be carried out without any
             restrictions on the independent variable t ...
              yes -- set info(4)=0
               no -- set info(4)=1
                     and define the stopping point me%tstop ****

  rtol, atol -- you must assign relative (rtol) and absolute (atol)
         error tolerances to tell the code how accurately you want
         the solution to be computed.  they must be defined as
         program variables because the code may change them.  you
         have two choices --
              both rtol and atol are scalars. (info(2)=0)
              both rtol and atol are vectors. (info(2)=1)
         in either case all components must be non-negative.

         the tolerances are used by the code in a local error test
         at each step which requires roughly that
                 abs(local error) &lt;= rtol*abs(y)+atol
         for each vector component.
         (more specifically, a euclidean norm is used to measure
         the size of vectors, and the error test uses the magnitude
         of the solution at the beginning of the step.)

         the true (global) error is the difference between the true
         solution of the initial value problem and the computed
         approximation.  practically all present day codes,
         including this one, control the local error at each step
         and do not even attempt to control the global error
         directly.  roughly speaking, they produce a solution y(t)
         which satisfies the differential equations with a
         residual r(t), dy(t)/dt = df(t,y(t)) + r(t),
         and, almost always, r(t) is bounded by the error
         tolerances.  usually, but not always, the true accuracy of
         the computed y is comparable to the error tolerances. this
         code will usually, but not always, deliver a more accurate
         solution if you reduce the tolerances and integrate again.
         by comparing two such solutions you can get a fairly
         reliable idea of the true error in the solution at the
         bigger tolerances.

         setting atol=0.0_wp results in a pure relative error test on
         that component. setting rtol=0. results in a pure absolute
         error test on that component.  a mixed test with non-zero
         rtol and atol corresponds roughly to a relative error
         test when the solution component is much bigger than atol
         and to an absolute error test when the solution component
         is smaller than the threshold atol.

         proper selection of the absolute error control parameters
         atol  requires you to have some idea of the scale of the
         solution components.  to acquire this information may mean
         that you will have to solve the problem more than once. in
         the absence of scale information, you should ask for some
         relative accuracy in all the components (by setting  rtol
         values non-zero) and perhaps impose extremely small
         absolute error tolerances to protect against the danger of
         a solution component becoming zero.

         the code will not attempt to compute a solution at an
         accuracy unreasonable for the machine being used.  it will
         advise you if you ask for too much accuracy and inform
         you as to the maximum accuracy it believes possible.
</pre></div>


<h3>output -- after any return from ddeabm</h3>
<p>the principal aim of the code is to return a computed solution at
   tout, although it is also possible to obtain intermediate results
   along the way.  to find out whether the code achieved its goal
   or if the integration process was interrupted before the task was
   completed, you must check the idid parameter.</p>
<div class="codehilite"><pre><span></span>  t -- the solution was successfully advanced to the
         output value of t.

  y(*) -- contains the computed solution approximation at t.
         you may also be interested in the approximate derivative
         of the solution at t.  it is contained in me%ypout.

  idid -- reports what the code did

                     *** task completed ***
               reported by positive values of idid

         idid = 1 -- a step was successfully taken in the
                   intermediate-output mode.  the code has not
                   yet reached tout.

         idid = 2 -- the integration to tout was successfully
                   completed (t=tout) by stepping exactly to tout.

         idid = 3 -- the integration to tout was successfully
                   completed (t=tout) by stepping past tout.
                   y(*) is obtained by interpolation.

                     *** task interrupted ***
               reported by negative values of idid

         idid = -1 -- a large amount of work has been expended.
                   (maxnum steps attempted)

         idid = -2 -- the error tolerances are too stringent.

         idid = -3 -- the local error test cannot be satisfied
                   because you specified a zero component in atol
                   and the corresponding computed solution
                   component is zero.  thus, a pure relative error
                   test is impossible for this component.

         idid = -4 -- the problem appears to be stiff.

         idid = -5,-6,-7,..,-32  -- not applicable for this code
                   but used by other members of depac or possible
                   future extensions.

                     *** task terminated ***
               reported by the value of idid=-33

         idid = -33 -- the code has encountered trouble from which
                   it cannot recover.  a message is printed
                   explaining the trouble and control is returned
                   to the calling program. for example, this occurs
                   when invalid input is detected.

  rtol, atol -- these quantities remain unchanged except when
         idid = -2.  in this case, the error tolerances have been
         increased by the code to values which are estimated to be
         appropriate for continuing the integration.  however, the
         reported solution at t was obtained using the input values
         of rtol and atol.
</pre></div>


<h3>input -- what to do to continue the integration (calls after the first)</h3>
<p>this code is organized so that subsequent calls to continue the
  integration involve little (if any) additional effort on your
  part. you must monitor the <code>idid</code> parameter in order to determine
  what to do next.</p>
<p>recalling that the principal task of the code is to integrate
  from <code>t</code> to <code>tout</code> (the interval mode), usually all you will need
  to do is specify a new <code>tout</code> upon reaching the current <code>tout</code>.</p>
<p>do not alter any quantity not specifically permitted below,
  in particular do not alter <code>neq</code>, <code>t</code>, <code>y(*)</code>, the internal work variables
  or the differential equation in subroutine <code>df</code>. any such alteration
  constitutes a new problem and must be treated as such, i.e.
  you must start afresh.</p>
<p>you cannot change from vector to scalar error control or vice
  versa (<code>info(2)</code>) but you can change the size of the entries of
  <code>rtol</code>, <code>atol</code>.  increasing a tolerance makes the equation easier
  to integrate.  decreasing a tolerance will make the equation
  harder to integrate and should generally be avoided.</p>
<p>you can switch from the intermediate-output mode to the
  interval mode (<code>info(3)</code>) or vice versa at any time.</p>
<p>if it has been necessary to prevent the integration from going
  past a point tstop (<code>info(4)</code>), keep in mind that the
  code will not integrate to any <code>tout</code> beyond the currently
  specified <code>tstop</code>.  once <code>tstop</code> has been reached you must change
  the value of <code>tstop</code> or set <code>info(4)=0</code>.  you may change <code>info(4)</code>
  or <code>tstop</code> at any time but you must supply the value of <code>tstop</code>
  whenever you set <code>info(4)=1</code>.</p>
<p>the parameter <code>info(1)</code> is used by the code to indicate the
  beginning of a new problem and to indicate whether integration
  is to be continued.  you must input the value <code>info(1)=0</code>
  when starting a new problem.  you must input the value
  <code>info(1)=1</code> if you wish to continue after an interrupted task.
  do not set <code>info(1)=0</code> on a continuation call unless you
  want the code to restart at the current <code>t</code>.</p>
<div class="codehilite"><pre><span></span>                     *** following a completed task ***
     if
         idid = 1, call the code again to continue the integration
                 another step in the direction of tout.

         idid = 2 or 3, define a new tout and call the code again.
                 tout must be different from t. you cannot change
                 the direction of integration without restarting.

                     *** following an interrupted task ***
                 to show the code that you realize the task was
                 interrupted and that you want to continue, you
                 must take appropriate action and reset info(1) = 1
     if
         idid = -1, the code has attempted maxnum steps.
                 if you want to continue, set info(1) = 1 and
                 call the code again. an additional maxnum steps
                 will be allowed.

         idid = -2, the error tolerances rtol, atol have been
                 increased to values the code estimates appropriate
                 for continuing.  you may want to change them
                 yourself.  if you are sure you want to continue
                 with relaxed error tolerances, set info(1)=1 and
                 call the code again.

         idid = -3, a solution component is zero and you set the
                 corresponding component of atol to zero.  if you
                 are sure you want to continue, you must first
                 alter the error criterion to use positive values
                 for those components of atol corresponding to zero
                 solution components, then set info(1)=1 and call
                 the code again.

         idid = -4, the problem appears to be stiff.  it is very
                 inefficient to solve such problems with ddeabm.
                 the code ddebdf in depac handles this task
                 efficiently.  if you are absolutely sure you want
                 to continue with ddeabm, set info(1)=1 and call
                 the code again.

                     *** following a terminated task ***
     if
         idid = -33, you cannot continue the solution of this
                 problem.  an attempt to do so will result in your
                 run being terminated.
</pre></div>


<h3>Authors</h3>
<ul>
<li>L. F. Shampine</li>
<li>H. A. Watts</li>
<li>M. K. Gordon</li>
</ul>
<h3>Reference</h3>
<ul>
<li>L. F. Shampine, H. A. Watts, "DEPAC - Design of a user oriented
     package of ode solvers", Report SAND79-2374, Sandia Laboratories, 1979.</li>
</ul>
<h3>History</h3>
<ul>
<li>820301  date written</li>
<li>890531  changed all specific intrinsics to generic.  (wrb)</li>
<li>890831  modified array declarations.  (wrb)</li>
<li>891006  cosmetic changes to prologue.  (wrb)</li>
<li>891024  changed references from dvnorm to dhvnrm.  (wrb)</li>
<li>891024  revision date from version 3.2</li>
<li>891214  prologue converted to version 4.0 format.  (bab)</li>
<li>900510  convert xerrwv calls to xermsg calls.  (rwc)</li>
<li>920501  reformatted the references section.  (wrb)</li>
<li>July, 2014 : Major refactoring into modern Fortran (jw)</li>
<li>December, 2015 : Additional refactoring (jw)</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-me%7E16"></span>class(<a href='../type/ddeabm_class.html'>ddeabm_class</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>me</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neq%7E5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>neq</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t%7E9"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y%7E4"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(neq)</td><td>::</td>
  <td><strong>y</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tout%7E2"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tout</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-info%7E2"></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(4)</td><td>::</td>
  <td><strong>info</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rtol%7E5"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rtol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-atol%7E5"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>atol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idid%7E4"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>idid</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
     <h3>Calls</h3>
     
                <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: proc~~ddeabm~~CallsGraph Pages: 1 -->
<svg id="procddeabmCallsGraph" width="168pt" height="32pt"
 viewBox="0.00 0.00 168.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ddeabm~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ddeabm~~CallsGraph</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 164,-28 164,4 -4,4"/>
<!-- proc~ddeabm -->
<g id="proc~~ddeabm~~CallsGraph_node1" class="node"><title>proc~ddeabm</title>
<polygon fill="none" stroke="black" points="54,-24 0,-24 0,-0 54,-0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ddeabm</text>
</g>
<!-- proc~report_error -->
<g id="proc~~ddeabm~~CallsGraph_node2" class="node"><title>proc~report_error</title>
<g id="a_proc~~ddeabm~~CallsGraph_node2"><a xlink:href="../proc/report_error.html" xlink:title="report_error">
<polygon fill="#d9534f" stroke="#d9534f" points="160,-24 90,-24 90,-0 160,-0 160,-24"/>
<text text-anchor="middle" x="125" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">report_error</text>
</a>
</g>
</g>
<!-- proc~ddeabm&#45;&gt;proc~report_error -->
<g id="proc~~ddeabm~~CallsGraph_edge1" class="edge"><title>proc~ddeabm&#45;&gt;proc~report_error</title>
<path fill="none" stroke="#000000" d="M54.2324,-12C62.1329,-12 71.0316,-12 79.7632,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.8668,-15.5001 89.8668,-12 79.8667,-8.5001 79.8668,-15.5001"/>
</g>
</g>
</svg>
</div>
                <div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div>
                <div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog">
                  <div class="modal-dialog modal-lg" role="document">
                    <div class="modal-content">
                      <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                        <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                      </div>
                      <div class="modal-body">
                        
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.36.0 (20140111.2315)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="559pt" height="32pt"
 viewBox="0.00 0.00 559.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-28 555,-28 555,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node"><title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="64,-24 0,-24 0,-0 64,-0 64,-24"/>
<text text-anchor="middle" x="32" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node"><title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="136,-24 82,-24 82,-0 136,-0 136,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node"><title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="209.25,-24 154.75,-24 154.75,-0 209.25,-0 209.25,-24"/>
<text text-anchor="middle" x="182" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node"><title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="364,-24 228,-24 228,-0 364,-0 364,-24"/>
<text text-anchor="middle" x="296" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node"><title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="436,-24 382,-24 382,-0 436,-0 436,-24"/>
<text text-anchor="middle" x="409" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node"><title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="551.25,-24 454.75,-24 454.75,-0 551.25,-0 551.25,-24"/>
<text text-anchor="middle" x="503" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    
                      </div>
                    </div>
                  </div>
                </div>
                
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      




















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ddeabm.html#src">ddeabm</a>
  </div>
</div>


    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">ddeabm</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">neq</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">rtol</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">idid</span><span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">me</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">neq</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">t</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">neq</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">tout</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">info</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">rtol</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">atol</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">idid</span>

    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xern3</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">error</span><span class="p">)</span> <span class="k">return</span>  <span class="c">! if user-triggered error</span>

    <span class="c">! check for an apparent infinite loop</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="n">me</span><span class="p">%</span><span class="n">tprev</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span> <span class="p">(</span><span class="n">xern3</span><span class="p">,</span> <span class="s1">&#39;(1pe15.6)&#39;</span><span class="p">)</span> <span class="n">t</span>
            <span class="k">call </span><span class="n">report_error</span><span class="p">(</span><span class="s1">&#39;ddeabm&#39;</span><span class="p">,&amp;</span>
                            <span class="s1">&#39;an apparent infinite loop has been detected.  &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;you have made repeated calls at t = &#39;</span> <span class="o">//</span> <span class="n">xern3</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39; and the integration has not advanced.  check the &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;way you have set parameters for the call to the &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;code, particularly info(1).&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">    end if</span>

    <span class="c">!make sure the deriv function was set:</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">df</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">report_error</span><span class="p">(</span><span class="s1">&#39;ddeabm&#39;</span><span class="p">,</span> <span class="s1">&#39;the derivative function DF &#39;</span><span class="o">//</span><span class="p">&amp;</span>
                        <span class="s1">&#39; has not been associated.&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">idid</span><span class="o">=-</span><span class="mi">33</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    </span><span class="n">me</span><span class="p">%</span><span class="n">tprev</span> <span class="o">=</span> <span class="n">t</span>

    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ddes</span><span class="p">(</span><span class="n">neq</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">rtol</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">idid</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">ypout</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">yp</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">yy</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">wt</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">alpha</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">beta</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">psi</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">v</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">w</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">sig</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">g</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">gi</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">h</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">eps</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">xold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">hold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">told</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">delsgn</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">tstop</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">twou</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">fouru</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">start</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">phase1</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">nornd</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">stiff</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">intout</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ns</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kord</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">kold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">init</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ksteps</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">kle4</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">iquit</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kprev</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ivc</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">iv</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kgi</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">error</span><span class="p">)</span> <span class="k">return</span> <span class="c">! user-triggered error</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">idid</span> <span class="o">/=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">/=</span> <span class="n">me</span><span class="p">%</span><span class="n">tprev</span><span class="p">)</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">end subroutine </span><span class="n">ddeabm</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>

  <section class="visible-xs visible-sm hidden-md">
    <hr>
    

<div class="panel panel-default">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#allprocs-1">All Procedures</a></h3></div>
  <div id="allprocs-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../proc/ddeabm.html">ddeabm</a>
      
      <a class="list-group-item" href="../proc/ddeabm_initialize.html">ddeabm_initialize</a>
      
      <a class="list-group-item" href="../proc/ddeabm_interp.html">ddeabm_interp</a>
      
      <a class="list-group-item" href="../proc/ddeabm_new_problem.html">ddeabm_new_problem</a>
      
      <a class="list-group-item" href="../proc/ddeabm_stop_integration.html">ddeabm_stop_integration</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_initialize.html">ddeabm_with_event_initialize</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_initialize_vec.html">ddeabm_with_event_initialize_vec</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_wrapper.html">ddeabm_with_event_wrapper</a>
      
      <a class="list-group-item" href="../proc/ddeabm_with_event_wrapper_vec.html">ddeabm_with_event_wrapper_vec</a>
      
      <a class="list-group-item" href="../proc/ddeabm_wrapper.html">ddeabm_wrapper</a>
      
      <a class="list-group-item" href="../proc/ddes.html">ddes</a>
      
      <a class="list-group-item" href="../proc/destroy_ddeabm.html">destroy_ddeabm</a>
      
      <a class="list-group-item" href="../proc/dhstrt.html">dhstrt</a>
      
      <a class="list-group-item" href="../proc/dhvnrm.html">dhvnrm</a>
      
      <a class="list-group-item" href="../proc/dintp.html">dintp</a>
      
      <a class="list-group-item" href="../proc/dsteps.html">dsteps</a>
      
      <a class="list-group-item" href="../proc/report_error.html">report_error</a>
      
      <a class="list-group-item" href="../proc/zeroin.html">zeroin</a>
      
    </div>
  </div>
</div>


  </section>

    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2019 </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ddeabm was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
        'HTML-CSS': { 
           styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
        }
      });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  </body>
</html>