<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
   <meta name="description" content="Modern Fortran Implementation of the DDEABM Adams-Bashforth-Moulton ODE Solver">
    
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="../favicon.png">

    <title>ddeabm &ndash; ddeabm</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">ddeabm </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
        
            <li><a href="../lists/absint.html">Abstract Interfaces</a></li>
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/absint.html">Abstract Interfaces</a></li>
                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>ddeabm
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.1% of total for procedures.">33 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/ddeabm_module.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/ddeabm_module.f90.html'>ddeabm_module.f90</a></li>
    
     <li><a href='../module/ddeabm_module.html'>ddeabm_module</a></li>
    
  
     <li class="active">ddeabm</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ddeabm.html#src">ddeabm</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
private subroutine ddeabm(me, neq, t, y, tout, info, rtol, atol, idid)
    
    
   
</h2>
    
  


    
    <p>solve an initial value problem in ordinary differential
  equations using an adams-bashforth method.</p>
<p>subroutine ddeabm uses the adams-bashforth-moulton
  predictor-corrector formulas of orders one through twelve to
  integrate a system of neq first order ordinary differential
  equations of the form <code>du/dx = df(x,u)</code>
  when the vector <code>y(*)</code> of initial values for <code>u(*)</code> at <code>x=t</code> is given.
  the subroutine integrates from <code>t</code> to <code>tout</code>. it is easy to continue the
  integration to get results at additional <code>tout</code>.  this is the interval
  mode of operation.  it is also easy for the routine to return with
  the solution at each intermediate step on the way to <code>tout</code>.  this is
  the intermediate-output mode of operation.</p>
<p>ddeabm is primarily designed to solve non-stiff and
  mildly stiff differential equations when derivative evaluations
  are expensive, high accuracy results are needed or answers at
  many specific points are required. ddeabm attempts to discover
  when it is not suitable for the task posed.</p>
<p><strong>quantities which are used as input items are:</strong>
    <code>neq, t, y(*), tout, info(*), rtol, atol</code></p>
<p><strong>quantities which may be altered by the code are:</strong>
    <code>t, y(*), info(1), rtol, atol, idid</code></p>
<h3>Description of the arguments to ddeabm (an overview)</h3>
<p>the parameters are</p>
<div class="codehilite"><pre><span></span><code>  <span class="n">df</span> <span class="o">--</span> <span class="n">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">a</span> <span class="n">subroutine</span> <span class="n">which</span> <span class="n">you</span> <span class="n">provide</span> <span class="n">to</span>
         <span class="n">define</span> <span class="n">the</span> <span class="n">differential</span> <span class="n">equations</span><span class="o">.</span>

  <span class="n">neq</span> <span class="o">--</span> <span class="n">this</span> <span class="k">is</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="p">(</span><span class="n">first</span> <span class="n">order</span><span class="p">)</span> <span class="n">differential</span>
         <span class="n">equations</span> <span class="n">to</span> <span class="n">be</span> <span class="n">integrated</span><span class="o">.</span>

  <span class="n">t</span> <span class="o">--</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">double</span> <span class="n">precision</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">independent</span>
       <span class="n">variable</span><span class="o">.</span>

  <span class="n">y</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">--</span> <span class="n">this</span> <span class="n">double</span> <span class="n">precision</span> <span class="n">array</span> <span class="n">contains</span> <span class="n">the</span> <span class="n">solution</span>
          <span class="n">components</span> <span class="n">at</span> <span class="n">t</span><span class="o">.</span>

  <span class="n">tout</span> <span class="o">--</span> <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">double</span> <span class="n">precision</span> <span class="n">point</span> <span class="n">at</span> <span class="n">which</span> <span class="n">a</span> <span class="n">solution</span> <span class="k">is</span>
          <span class="n">desired</span><span class="o">.</span>

  <span class="n">info</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">--</span> <span class="n">the</span> <span class="n">basic</span> <span class="n">task</span> <span class="n">of</span> <span class="n">the</span> <span class="n">code</span> <span class="k">is</span> <span class="n">to</span> <span class="n">integrate</span> <span class="n">the</span>
         <span class="n">differential</span> <span class="n">equations</span> <span class="n">from</span> <span class="n">t</span> <span class="n">to</span> <span class="n">tout</span> <span class="ow">and</span> <span class="k">return</span> <span class="n">an</span>
         <span class="n">answer</span> <span class="n">at</span> <span class="n">tout</span><span class="o">.</span>  <span class="n">info</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">is</span> <span class="n">an</span> <span class="n">integer</span> <span class="n">array</span> <span class="n">which</span> <span class="k">is</span> <span class="n">used</span>
         <span class="n">to</span> <span class="n">communicate</span> <span class="n">exactly</span> <span class="n">how</span> <span class="n">you</span> <span class="n">want</span> <span class="n">this</span> <span class="n">task</span> <span class="n">to</span> <span class="n">be</span>
         <span class="n">carried</span> <span class="n">out</span><span class="o">.</span>

  <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">--</span> <span class="n">these</span> <span class="n">double</span> <span class="n">precision</span> <span class="n">quantities</span> <span class="n">represent</span>
                <span class="n">relative</span> <span class="ow">and</span> <span class="n">absolute</span> <span class="n">error</span> <span class="n">tolerances</span> <span class="n">which</span> <span class="n">you</span>
                <span class="n">provide</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">how</span> <span class="n">accurately</span> <span class="n">you</span> <span class="n">wish</span> <span class="n">the</span>
                <span class="n">solution</span> <span class="n">to</span> <span class="n">be</span> <span class="n">computed</span><span class="o">.</span>  <span class="n">you</span> <span class="n">may</span> <span class="n">choose</span> <span class="n">them</span> <span class="n">to</span> <span class="n">be</span>
                <span class="n">both</span> <span class="n">scalars</span> <span class="ow">or</span> <span class="k">else</span> <span class="n">both</span> <span class="n">vectors</span><span class="o">.</span>

  <span class="n">idid</span> <span class="o">--</span> <span class="n">this</span> <span class="n">scalar</span> <span class="n">quantity</span> <span class="k">is</span> <span class="n">an</span> <span class="n">indicator</span> <span class="n">reporting</span> <span class="n">what</span>
         <span class="n">the</span> <span class="n">code</span> <span class="n">did</span><span class="o">.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">monitor</span> <span class="n">this</span> <span class="n">integer</span> <span class="n">variable</span> <span class="n">to</span>
         <span class="n">decide</span> <span class="n">what</span> <span class="n">action</span> <span class="n">to</span> <span class="n">take</span> <span class="n">next</span><span class="o">.</span>
</code></pre></div>

<h3>input -- what to do on the first call to ddeabm</h3>
<p>the first call of the code is defined to be the start of each new
   problem.  read through the descriptions of all the following items,
   provide sufficient storage space for designated arrays, set
   appropriate variables for the initialization of the problem, and
   give information about how you want the problem to be solved.</p>
<div class="codehilite"><pre><span></span><code>  <span class="n">df</span> <span class="o">--</span> <span class="n">provide</span> <span class="n">a</span> <span class="n">subroutine</span> <span class="n">of</span> <span class="n">the</span> <span class="n">form</span>
                           <span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">uprime</span><span class="p">)</span>
         <span class="n">to</span> <span class="n">define</span> <span class="n">the</span> <span class="n">system</span> <span class="n">of</span> <span class="n">first</span> <span class="n">order</span> <span class="n">differential</span> <span class="n">equations</span>
         <span class="n">which</span> <span class="k">is</span> <span class="n">to</span> <span class="n">be</span> <span class="n">solved</span><span class="o">.</span>  <span class="k">for</span> <span class="n">the</span> <span class="n">given</span> <span class="n">values</span> <span class="n">of</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">the</span>
         <span class="n">vector</span> <span class="n">u</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">=</span><span class="p">(</span><span class="n">u</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span><span class="n">u</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span><span class="o">...</span><span class="p">,</span><span class="n">u</span><span class="p">(</span><span class="n">neq</span><span class="p">)),</span> <span class="n">the</span> <span class="n">subroutine</span> <span class="n">must</span>
         <span class="n">evaluate</span> <span class="n">the</span> <span class="n">neq</span> <span class="n">components</span> <span class="n">of</span> <span class="n">the</span> <span class="n">system</span> <span class="n">of</span> <span class="n">differential</span>
         <span class="n">equations</span> <span class="n">du</span><span class="o">/</span><span class="n">dx</span><span class="o">=</span><span class="n">df</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">)</span> <span class="ow">and</span> <span class="n">store</span> <span class="n">the</span> <span class="n">derivatives</span> <span class="ow">in</span> <span class="n">the</span>
         <span class="n">array</span> <span class="n">uprime</span><span class="p">(</span><span class="o">*</span><span class="p">),</span> <span class="n">that</span> <span class="k">is</span><span class="p">,</span> <span class="n">uprime</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">du</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">/</span><span class="n">dx</span> <span class="k">for</span>
         <span class="n">equations</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">...</span><span class="p">,</span><span class="n">neq</span><span class="o">.</span>

         <span class="n">subroutine</span> <span class="n">df</span> <span class="n">must</span> <span class="ow">not</span> <span class="n">alter</span> <span class="n">x</span> <span class="ow">or</span> <span class="n">u</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="o">.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">declare</span>
         <span class="n">the</span> <span class="n">name</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">an</span> <span class="n">external</span> <span class="n">statement</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">program</span> <span class="n">that</span>
         <span class="n">calls</span> <span class="n">ddeabm</span><span class="o">.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">dimension</span> <span class="n">u</span> <span class="ow">and</span> <span class="n">uprime</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span>

  <span class="n">neq</span> <span class="o">--</span> <span class="n">set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">number</span> <span class="n">of</span> <span class="n">differential</span> <span class="n">equations</span><span class="o">.</span>
         <span class="p">(</span><span class="n">neq</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)</span>

  <span class="n">t</span> <span class="o">--</span> <span class="n">set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">point</span> <span class="n">of</span> <span class="n">the</span> <span class="n">integration</span><span class="o">.</span>
         <span class="n">you</span> <span class="n">must</span> <span class="n">use</span> <span class="n">a</span> <span class="n">program</span> <span class="n">variable</span> <span class="k">for</span> <span class="n">t</span> <span class="n">because</span> <span class="n">the</span> <span class="n">code</span>
         <span class="n">changes</span> <span class="n">its</span> <span class="n">value</span><span class="o">.</span>

  <span class="n">y</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">--</span> <span class="n">set</span> <span class="n">this</span> <span class="n">vector</span> <span class="n">to</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">values</span> <span class="n">of</span> <span class="n">the</span> <span class="n">neq</span> <span class="n">solution</span>
         <span class="n">components</span> <span class="n">at</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">point</span><span class="o">.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">dimension</span> <span class="n">y</span> <span class="n">at</span>
         <span class="n">least</span> <span class="n">neq</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">calling</span> <span class="n">program</span><span class="o">.</span>

  <span class="n">tout</span> <span class="o">--</span> <span class="n">set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">the</span> <span class="n">first</span> <span class="n">point</span> <span class="n">at</span> <span class="n">which</span> <span class="n">a</span> <span class="n">solution</span>
         <span class="k">is</span> <span class="n">desired</span><span class="o">.</span>  <span class="n">you</span> <span class="n">can</span> <span class="n">take</span> <span class="n">tout</span> <span class="o">=</span> <span class="n">t</span><span class="p">,</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">case</span> <span class="n">the</span> <span class="n">code</span>
         <span class="n">will</span> <span class="n">evaluate</span> <span class="n">the</span> <span class="n">derivative</span> <span class="n">of</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">at</span> <span class="n">t</span> <span class="ow">and</span>
         <span class="k">return</span><span class="o">.</span> <span class="n">integration</span> <span class="n">either</span> <span class="n">forward</span> <span class="ow">in</span> <span class="n">t</span> <span class="p">(</span><span class="n">tout</span> <span class="o">&gt;</span> <span class="n">t</span><span class="p">)</span> <span class="ow">or</span>
         <span class="n">backward</span> <span class="ow">in</span> <span class="n">t</span> <span class="p">(</span><span class="n">tout</span> <span class="o">&lt;</span> <span class="n">t</span><span class="p">)</span> <span class="k">is</span> <span class="n">permitted</span><span class="o">.</span>

         <span class="n">the</span> <span class="n">code</span> <span class="n">advances</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">from</span> <span class="n">t</span> <span class="n">to</span> <span class="n">tout</span> <span class="n">using</span>
         <span class="n">step</span> <span class="n">sizes</span> <span class="n">which</span> <span class="n">are</span> <span class="n">automatically</span> <span class="n">selected</span> <span class="n">so</span> <span class="k">as</span> <span class="n">to</span>
         <span class="n">achieve</span> <span class="n">the</span> <span class="n">desired</span> <span class="n">accuracy</span><span class="o">.</span>  <span class="k">if</span> <span class="n">you</span> <span class="n">wish</span><span class="p">,</span> <span class="n">the</span> <span class="n">code</span> <span class="n">will</span>
         <span class="k">return</span> <span class="n">with</span> <span class="n">the</span> <span class="n">solution</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">derivative</span> <span class="n">following</span>
         <span class="n">each</span> <span class="n">intermediate</span> <span class="n">step</span> <span class="p">(</span><span class="n">intermediate</span><span class="o">-</span><span class="n">output</span> <span class="n">mode</span><span class="p">)</span> <span class="n">so</span> <span class="n">that</span>
         <span class="n">you</span> <span class="n">can</span> <span class="n">monitor</span> <span class="n">them</span><span class="p">,</span> <span class="n">but</span> <span class="n">you</span> <span class="n">still</span> <span class="n">must</span> <span class="n">provide</span> <span class="n">tout</span> <span class="ow">in</span>
         <span class="n">accord</span> <span class="n">with</span> <span class="n">the</span> <span class="n">basic</span> <span class="n">aim</span> <span class="n">of</span> <span class="n">the</span> <span class="n">code</span><span class="o">.</span>

         <span class="n">the</span> <span class="n">first</span> <span class="n">step</span> <span class="n">taken</span> <span class="n">by</span> <span class="n">the</span> <span class="n">code</span> <span class="k">is</span> <span class="n">a</span> <span class="n">critical</span> <span class="n">one</span>
         <span class="n">because</span> <span class="n">it</span> <span class="n">must</span> <span class="n">reflect</span> <span class="n">how</span> <span class="n">fast</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">changes</span> <span class="n">near</span>
         <span class="n">the</span> <span class="n">initial</span> <span class="n">point</span><span class="o">.</span>  <span class="n">the</span> <span class="n">code</span> <span class="n">automatically</span> <span class="n">selects</span> <span class="n">an</span>
         <span class="n">initial</span> <span class="n">step</span> <span class="n">size</span> <span class="n">which</span> <span class="k">is</span> <span class="n">practically</span> <span class="n">always</span> <span class="n">suitable</span> <span class="k">for</span>
         <span class="n">the</span> <span class="n">problem</span><span class="o">.</span> <span class="n">by</span> <span class="n">using</span> <span class="n">the</span> <span class="n">fact</span> <span class="n">that</span> <span class="n">the</span> <span class="n">code</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">step</span>
         <span class="n">past</span> <span class="n">tout</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">first</span> <span class="n">step</span><span class="p">,</span> <span class="n">you</span> <span class="n">could</span><span class="p">,</span> <span class="k">if</span> <span class="n">necessary</span><span class="p">,</span>
         <span class="n">restrict</span> <span class="n">the</span> <span class="n">length</span> <span class="n">of</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">step</span> <span class="n">size</span><span class="o">.</span>

         <span class="k">for</span> <span class="n">some</span> <span class="n">problems</span> <span class="n">it</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">permissible</span> <span class="n">to</span> <span class="n">integrate</span>
         <span class="n">past</span> <span class="n">a</span> <span class="n">point</span> <span class="n">tstop</span> <span class="n">because</span> <span class="n">a</span> <span class="n">discontinuity</span> <span class="n">occurs</span> <span class="n">there</span>
         <span class="ow">or</span> <span class="n">the</span> <span class="n">solution</span> <span class="ow">or</span> <span class="n">its</span> <span class="n">derivative</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">defined</span> <span class="n">beyond</span>
         <span class="n">tstop</span><span class="o">.</span>  <span class="n">when</span> <span class="n">you</span> <span class="n">have</span> <span class="n">declared</span> <span class="n">a</span> <span class="n">tstop</span> <span class="n">point</span> <span class="p">(</span><span class="n">see</span> <span class="n">info</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span>
         <span class="n">you</span> <span class="n">have</span> <span class="n">told</span> <span class="n">the</span> <span class="n">code</span> <span class="ow">not</span> <span class="n">to</span> <span class="n">integrate</span> <span class="n">past</span> <span class="n">tstop</span><span class="o">.</span>
         <span class="ow">in</span> <span class="n">this</span> <span class="n">case</span> <span class="n">any</span> <span class="n">tout</span> <span class="n">beyond</span> <span class="n">tstop</span> <span class="k">is</span> <span class="n">invalid</span> <span class="n">input</span><span class="o">.</span>

  <span class="n">info</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="o">--</span> <span class="n">use</span> <span class="n">the</span> <span class="n">info</span> <span class="n">array</span> <span class="n">to</span> <span class="n">give</span> <span class="n">the</span> <span class="n">code</span> <span class="n">more</span> <span class="n">details</span> <span class="n">about</span>
         <span class="n">how</span> <span class="n">you</span> <span class="n">want</span> <span class="n">your</span> <span class="n">problem</span> <span class="n">solved</span><span class="o">.</span>  <span class="n">this</span> <span class="n">array</span> <span class="n">should</span> <span class="n">be</span>
         <span class="n">dimensioned</span> <span class="n">of</span> <span class="n">length</span> <span class="mf">4.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">respond</span> <span class="n">to</span> <span class="n">all</span> <span class="n">of</span>
         <span class="n">the</span> <span class="n">following</span> <span class="n">items</span> <span class="n">which</span> <span class="n">are</span> <span class="n">arranged</span> <span class="k">as</span> <span class="n">questions</span><span class="o">.</span>  <span class="n">the</span>
         <span class="n">simplest</span> <span class="n">use</span> <span class="n">of</span> <span class="n">the</span> <span class="n">code</span> <span class="n">corresponds</span> <span class="n">to</span> <span class="n">answering</span> <span class="n">all</span>
         <span class="n">questions</span> <span class="k">as</span> <span class="n">yes</span> <span class="p">,</span><span class="n">i</span><span class="o">.</span><span class="n">e</span><span class="o">.</span> <span class="n">setting</span> <span class="n">all</span> <span class="n">entries</span> <span class="n">of</span> <span class="n">info</span> <span class="n">to</span> <span class="mf">0.</span>

    <span class="n">info</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">--</span> <span class="n">this</span> <span class="n">parameter</span> <span class="n">enables</span> <span class="n">the</span> <span class="n">code</span> <span class="n">to</span> <span class="n">initialize</span>
           <span class="n">itself</span><span class="o">.</span>  <span class="n">you</span> <span class="n">must</span> <span class="n">set</span> <span class="n">it</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">the</span> <span class="n">start</span> <span class="n">of</span> <span class="n">every</span>
           <span class="n">new</span> <span class="n">problem</span><span class="o">.</span>

        <span class="o">****</span> <span class="k">is</span> <span class="n">this</span> <span class="n">the</span> <span class="n">first</span> <span class="n">call</span> <span class="k">for</span> <span class="n">this</span> <span class="n">problem</span> <span class="o">...</span>
              <span class="n">yes</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
               <span class="n">no</span> <span class="o">--</span> <span class="ow">not</span> <span class="n">applicable</span> <span class="n">here</span><span class="o">.</span>
                     <span class="n">see</span> <span class="n">below</span> <span class="k">for</span> <span class="n">continuation</span> <span class="n">calls</span><span class="o">.</span>  <span class="o">****</span>

    <span class="n">info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">--</span> <span class="n">how</span> <span class="n">much</span> <span class="n">accuracy</span> <span class="n">you</span> <span class="n">want</span> <span class="n">of</span> <span class="n">your</span> <span class="n">solution</span>
           <span class="k">is</span> <span class="n">specified</span> <span class="n">by</span> <span class="n">the</span> <span class="n">error</span> <span class="n">tolerances</span> <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span><span class="o">.</span>
           <span class="n">the</span> <span class="n">simplest</span> <span class="n">use</span> <span class="k">is</span> <span class="n">to</span> <span class="n">take</span> <span class="n">them</span> <span class="n">both</span> <span class="n">to</span> <span class="n">be</span> <span class="n">scalars</span><span class="o">.</span>
           <span class="n">to</span> <span class="n">obtain</span> <span class="n">more</span> <span class="n">flexibility</span><span class="p">,</span> <span class="n">they</span> <span class="n">can</span> <span class="n">both</span> <span class="n">be</span> <span class="n">vectors</span><span class="o">.</span>
           <span class="n">the</span> <span class="n">code</span> <span class="n">must</span> <span class="n">be</span> <span class="n">told</span> <span class="n">your</span> <span class="n">choice</span><span class="o">.</span>

        <span class="o">****</span> <span class="n">are</span> <span class="n">both</span> <span class="n">error</span> <span class="n">tolerances</span> <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="n">scalars</span> <span class="o">...</span>
              <span class="n">yes</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
                     <span class="ow">and</span> <span class="n">input</span> <span class="n">scalars</span> <span class="k">for</span> <span class="n">both</span> <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span>
               <span class="n">no</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
                     <span class="ow">and</span> <span class="n">input</span> <span class="n">arrays</span> <span class="k">for</span> <span class="n">both</span> <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span> <span class="o">****</span>

    <span class="n">info</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">--</span> <span class="n">the</span> <span class="n">code</span> <span class="n">integrates</span> <span class="n">from</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">direction</span>
           <span class="n">of</span> <span class="n">tout</span> <span class="n">by</span> <span class="n">steps</span><span class="o">.</span>  <span class="k">if</span> <span class="n">you</span> <span class="n">wish</span><span class="p">,</span> <span class="n">it</span> <span class="n">will</span> <span class="k">return</span> <span class="n">the</span>
           <span class="n">computed</span> <span class="n">solution</span> <span class="ow">and</span> <span class="n">derivative</span> <span class="n">at</span> <span class="n">the</span> <span class="n">next</span>
           <span class="n">intermediate</span> <span class="n">step</span> <span class="p">(</span><span class="n">the</span> <span class="n">intermediate</span><span class="o">-</span><span class="n">output</span> <span class="n">mode</span><span class="p">)</span> <span class="ow">or</span>
           <span class="n">tout</span><span class="p">,</span> <span class="n">whichever</span> <span class="n">comes</span> <span class="n">first</span><span class="o">.</span>  <span class="n">this</span> <span class="k">is</span> <span class="n">a</span> <span class="n">good</span> <span class="n">way</span> <span class="n">to</span>
           <span class="n">proceed</span> <span class="k">if</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">see</span> <span class="n">the</span> <span class="n">behavior</span> <span class="n">of</span> <span class="n">the</span> <span class="n">solution</span><span class="o">.</span>
           <span class="k">if</span> <span class="n">you</span> <span class="n">must</span> <span class="n">have</span> <span class="n">solutions</span> <span class="n">at</span> <span class="n">a</span> <span class="n">great</span> <span class="n">many</span> <span class="n">specific</span>
           <span class="n">tout</span> <span class="n">points</span><span class="p">,</span> <span class="n">this</span> <span class="n">code</span> <span class="n">will</span> <span class="n">compute</span> <span class="n">them</span> <span class="n">efficiently</span><span class="o">.</span>

        <span class="o">****</span> <span class="n">do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">only</span> <span class="n">at</span>
             <span class="n">tout</span> <span class="p">(</span><span class="ow">and</span> <span class="ow">not</span> <span class="n">at</span> <span class="n">the</span> <span class="n">next</span> <span class="n">intermediate</span> <span class="n">step</span><span class="p">)</span> <span class="o">...</span>
              <span class="n">yes</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
               <span class="n">no</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">****</span>

    <span class="n">info</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">--</span> <span class="n">to</span> <span class="n">handle</span> <span class="n">solutions</span> <span class="n">at</span> <span class="n">a</span> <span class="n">great</span> <span class="n">many</span> <span class="n">specific</span>
           <span class="n">values</span> <span class="n">tout</span> <span class="n">efficiently</span><span class="p">,</span> <span class="n">this</span> <span class="n">code</span> <span class="n">may</span> <span class="n">integrate</span> <span class="n">past</span>
           <span class="n">tout</span> <span class="ow">and</span> <span class="n">interpolate</span> <span class="n">to</span> <span class="n">obtain</span> <span class="n">the</span> <span class="n">result</span> <span class="n">at</span> <span class="n">tout</span><span class="o">.</span>
           <span class="n">sometimes</span> <span class="n">it</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">integrate</span> <span class="n">beyond</span> <span class="n">some</span>
           <span class="n">point</span> <span class="n">tstop</span> <span class="n">because</span> <span class="n">the</span> <span class="n">equation</span> <span class="n">changes</span> <span class="n">there</span> <span class="ow">or</span> <span class="n">it</span> <span class="k">is</span>
           <span class="ow">not</span> <span class="n">defined</span> <span class="n">past</span> <span class="n">tstop</span><span class="o">.</span>  <span class="n">then</span> <span class="n">you</span> <span class="n">must</span> <span class="n">tell</span> <span class="n">the</span> <span class="n">code</span>
           <span class="ow">not</span> <span class="n">to</span> <span class="n">go</span> <span class="n">past</span><span class="o">.</span>

        <span class="o">****</span> <span class="n">can</span> <span class="n">the</span> <span class="n">integration</span> <span class="n">be</span> <span class="n">carried</span> <span class="n">out</span> <span class="n">without</span> <span class="n">any</span>
             <span class="n">restrictions</span> <span class="n">on</span> <span class="n">the</span> <span class="n">independent</span> <span class="n">variable</span> <span class="n">t</span> <span class="o">...</span>
              <span class="n">yes</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
               <span class="n">no</span> <span class="o">--</span> <span class="n">set</span> <span class="n">info</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
                     <span class="ow">and</span> <span class="n">define</span> <span class="n">the</span> <span class="n">stopping</span> <span class="n">point</span> <span class="n">me</span><span class="o">%</span><span class="n">tstop</span> <span class="o">****</span>

  <span class="n">rtol</span><span class="p">,</span> <span class="n">atol</span> <span class="o">--</span> <span class="n">you</span> <span class="n">must</span> <span class="n">assign</span> <span class="n">relative</span> <span class="p">(</span><span class="n">rtol</span><span class="p">)</span> <span class="ow">and</span> <span class="n">absolute</span> <span class="p">(</span><span class="n">atol</span><span class="p">)</span>
         <span class="n">error</span> <span class="n">tolerances</span> <span class="n">to</span> <span class="n">tell</span> <span class="n">the</span> <span class="n">code</span> <span class="n">how</span> <span class="n">accurately</span> <span class="n">you</span> <span class="n">want</span>
         <span class="n">the</span> <span class="n">solution</span> <span class="n">to</span> <span class="n">be</span> <span class="n">computed</span><span class="o">.</span>  <span class="n">they</span> <span class="n">must</span> <span class="n">be</span> <span class="n">defined</span> <span class="k">as</span>
         <span class="n">program</span> <span class="n">variables</span> <span class="n">because</span> <span class="n">the</span> <span class="n">code</span> <span class="n">may</span> <span class="n">change</span> <span class="n">them</span><span class="o">.</span>  <span class="n">you</span>
         <span class="n">have</span> <span class="n">two</span> <span class="n">choices</span> <span class="o">--</span>
              <span class="n">both</span> <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span> <span class="n">are</span> <span class="n">scalars</span><span class="o">.</span> <span class="p">(</span><span class="n">info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
              <span class="n">both</span> <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span> <span class="n">are</span> <span class="n">vectors</span><span class="o">.</span> <span class="p">(</span><span class="n">info</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
         <span class="ow">in</span> <span class="n">either</span> <span class="n">case</span> <span class="n">all</span> <span class="n">components</span> <span class="n">must</span> <span class="n">be</span> <span class="n">non</span><span class="o">-</span><span class="n">negative</span><span class="o">.</span>

         <span class="n">the</span> <span class="n">tolerances</span> <span class="n">are</span> <span class="n">used</span> <span class="n">by</span> <span class="n">the</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">local</span> <span class="n">error</span> <span class="n">test</span>
         <span class="n">at</span> <span class="n">each</span> <span class="n">step</span> <span class="n">which</span> <span class="n">requires</span> <span class="n">roughly</span> <span class="n">that</span>
                 <span class="nb">abs</span><span class="p">(</span><span class="n">local</span> <span class="n">error</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">rtol</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">+</span><span class="n">atol</span>
         <span class="k">for</span> <span class="n">each</span> <span class="n">vector</span> <span class="n">component</span><span class="o">.</span>
         <span class="p">(</span><span class="n">more</span> <span class="n">specifically</span><span class="p">,</span> <span class="n">a</span> <span class="n">euclidean</span> <span class="n">norm</span> <span class="k">is</span> <span class="n">used</span> <span class="n">to</span> <span class="n">measure</span>
         <span class="n">the</span> <span class="n">size</span> <span class="n">of</span> <span class="n">vectors</span><span class="p">,</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">error</span> <span class="n">test</span> <span class="n">uses</span> <span class="n">the</span> <span class="n">magnitude</span>
         <span class="n">of</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">at</span> <span class="n">the</span> <span class="n">beginning</span> <span class="n">of</span> <span class="n">the</span> <span class="n">step</span><span class="o">.</span><span class="p">)</span>

         <span class="n">the</span> <span class="bp">true</span> <span class="p">(</span><span class="n">global</span><span class="p">)</span> <span class="n">error</span> <span class="k">is</span> <span class="n">the</span> <span class="n">difference</span> <span class="n">between</span> <span class="n">the</span> <span class="bp">true</span>
         <span class="n">solution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">initial</span> <span class="n">value</span> <span class="n">problem</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">computed</span>
         <span class="n">approximation</span><span class="o">.</span>  <span class="n">practically</span> <span class="n">all</span> <span class="n">present</span> <span class="n">day</span> <span class="n">codes</span><span class="p">,</span>
         <span class="n">including</span> <span class="n">this</span> <span class="n">one</span><span class="p">,</span> <span class="n">control</span> <span class="n">the</span> <span class="n">local</span> <span class="n">error</span> <span class="n">at</span> <span class="n">each</span> <span class="n">step</span>
         <span class="ow">and</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">even</span> <span class="n">attempt</span> <span class="n">to</span> <span class="n">control</span> <span class="n">the</span> <span class="n">global</span> <span class="n">error</span>
         <span class="n">directly</span><span class="o">.</span>  <span class="n">roughly</span> <span class="n">speaking</span><span class="p">,</span> <span class="n">they</span> <span class="n">produce</span> <span class="n">a</span> <span class="n">solution</span> <span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
         <span class="n">which</span> <span class="n">satisfies</span> <span class="n">the</span> <span class="n">differential</span> <span class="n">equations</span> <span class="n">with</span> <span class="n">a</span>
         <span class="n">residual</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">dy</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="n">dt</span> <span class="o">=</span> <span class="n">df</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="o">+</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">),</span>
         <span class="ow">and</span><span class="p">,</span> <span class="n">almost</span> <span class="n">always</span><span class="p">,</span> <span class="n">r</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">is</span> <span class="n">bounded</span> <span class="n">by</span> <span class="n">the</span> <span class="n">error</span>
         <span class="n">tolerances</span><span class="o">.</span>  <span class="n">usually</span><span class="p">,</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">always</span><span class="p">,</span> <span class="n">the</span> <span class="bp">true</span> <span class="n">accuracy</span> <span class="n">of</span>
         <span class="n">the</span> <span class="n">computed</span> <span class="n">y</span> <span class="k">is</span> <span class="n">comparable</span> <span class="n">to</span> <span class="n">the</span> <span class="n">error</span> <span class="n">tolerances</span><span class="o">.</span> <span class="n">this</span>
         <span class="n">code</span> <span class="n">will</span> <span class="n">usually</span><span class="p">,</span> <span class="n">but</span> <span class="ow">not</span> <span class="n">always</span><span class="p">,</span> <span class="n">deliver</span> <span class="n">a</span> <span class="n">more</span> <span class="n">accurate</span>
         <span class="n">solution</span> <span class="k">if</span> <span class="n">you</span> <span class="n">reduce</span> <span class="n">the</span> <span class="n">tolerances</span> <span class="ow">and</span> <span class="n">integrate</span> <span class="n">again</span><span class="o">.</span>
         <span class="n">by</span> <span class="n">comparing</span> <span class="n">two</span> <span class="n">such</span> <span class="n">solutions</span> <span class="n">you</span> <span class="n">can</span> <span class="n">get</span> <span class="n">a</span> <span class="n">fairly</span>
         <span class="n">reliable</span> <span class="n">idea</span> <span class="n">of</span> <span class="n">the</span> <span class="bp">true</span> <span class="n">error</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">at</span> <span class="n">the</span>
         <span class="n">bigger</span> <span class="n">tolerances</span><span class="o">.</span>

         <span class="n">setting</span> <span class="n">atol</span><span class="o">=</span><span class="mf">0.0</span><span class="n">_wp</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">pure</span> <span class="n">relative</span> <span class="n">error</span> <span class="n">test</span> <span class="n">on</span>
         <span class="n">that</span> <span class="n">component</span><span class="o">.</span> <span class="n">setting</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">0.</span> <span class="n">results</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">pure</span> <span class="n">absolute</span>
         <span class="n">error</span> <span class="n">test</span> <span class="n">on</span> <span class="n">that</span> <span class="n">component</span><span class="o">.</span>  <span class="n">a</span> <span class="n">mixed</span> <span class="n">test</span> <span class="n">with</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span>
         <span class="n">rtol</span> <span class="ow">and</span> <span class="n">atol</span> <span class="n">corresponds</span> <span class="n">roughly</span> <span class="n">to</span> <span class="n">a</span> <span class="n">relative</span> <span class="n">error</span>
         <span class="n">test</span> <span class="n">when</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">component</span> <span class="k">is</span> <span class="n">much</span> <span class="n">bigger</span> <span class="n">than</span> <span class="n">atol</span>
         <span class="ow">and</span> <span class="n">to</span> <span class="n">an</span> <span class="n">absolute</span> <span class="n">error</span> <span class="n">test</span> <span class="n">when</span> <span class="n">the</span> <span class="n">solution</span> <span class="n">component</span>
         <span class="k">is</span> <span class="n">smaller</span> <span class="n">than</span> <span class="n">the</span> <span class="n">threshold</span> <span class="n">atol</span><span class="o">.</span>

         <span class="n">proper</span> <span class="n">selection</span> <span class="n">of</span> <span class="n">the</span> <span class="n">absolute</span> <span class="n">error</span> <span class="n">control</span> <span class="n">parameters</span>
         <span class="n">atol</span>  <span class="n">requires</span> <span class="n">you</span> <span class="n">to</span> <span class="n">have</span> <span class="n">some</span> <span class="n">idea</span> <span class="n">of</span> <span class="n">the</span> <span class="n">scale</span> <span class="n">of</span> <span class="n">the</span>
         <span class="n">solution</span> <span class="n">components</span><span class="o">.</span>  <span class="n">to</span> <span class="n">acquire</span> <span class="n">this</span> <span class="n">information</span> <span class="n">may</span> <span class="n">mean</span>
         <span class="n">that</span> <span class="n">you</span> <span class="n">will</span> <span class="n">have</span> <span class="n">to</span> <span class="n">solve</span> <span class="n">the</span> <span class="n">problem</span> <span class="n">more</span> <span class="n">than</span> <span class="n">once</span><span class="o">.</span> <span class="ow">in</span>
         <span class="n">the</span> <span class="n">absence</span> <span class="n">of</span> <span class="n">scale</span> <span class="n">information</span><span class="p">,</span> <span class="n">you</span> <span class="n">should</span> <span class="n">ask</span> <span class="k">for</span> <span class="n">some</span>
         <span class="n">relative</span> <span class="n">accuracy</span> <span class="ow">in</span> <span class="n">all</span> <span class="n">the</span> <span class="n">components</span> <span class="p">(</span><span class="n">by</span> <span class="n">setting</span>  <span class="n">rtol</span>
         <span class="n">values</span> <span class="n">non</span><span class="o">-</span><span class="n">zero</span><span class="p">)</span> <span class="ow">and</span> <span class="n">perhaps</span> <span class="n">impose</span> <span class="n">extremely</span> <span class="n">small</span>
         <span class="n">absolute</span> <span class="n">error</span> <span class="n">tolerances</span> <span class="n">to</span> <span class="n">protect</span> <span class="n">against</span> <span class="n">the</span> <span class="n">danger</span> <span class="n">of</span>
         <span class="n">a</span> <span class="n">solution</span> <span class="n">component</span> <span class="n">becoming</span> <span class="n">zero</span><span class="o">.</span>

         <span class="n">the</span> <span class="n">code</span> <span class="n">will</span> <span class="ow">not</span> <span class="n">attempt</span> <span class="n">to</span> <span class="n">compute</span> <span class="n">a</span> <span class="n">solution</span> <span class="n">at</span> <span class="n">an</span>
         <span class="n">accuracy</span> <span class="n">unreasonable</span> <span class="k">for</span> <span class="n">the</span> <span class="n">machine</span> <span class="n">being</span> <span class="n">used</span><span class="o">.</span>  <span class="n">it</span> <span class="n">will</span>
         <span class="n">advise</span> <span class="n">you</span> <span class="k">if</span> <span class="n">you</span> <span class="n">ask</span> <span class="k">for</span> <span class="n">too</span> <span class="n">much</span> <span class="n">accuracy</span> <span class="ow">and</span> <span class="n">inform</span>
         <span class="n">you</span> <span class="k">as</span> <span class="n">to</span> <span class="n">the</span> <span class="n">maximum</span> <span class="n">accuracy</span> <span class="n">it</span> <span class="n">believes</span> <span class="n">possible</span><span class="o">.</span>
</code></pre></div>

<h3>output -- after any return from ddeabm</h3>
<p>the principal aim of the code is to return a computed solution at
   tout, although it is also possible to obtain intermediate results
   along the way.  to find out whether the code achieved its goal
   or if the integration process was interrupted before the task was
   completed, you must check the idid parameter.</p>
<div class="codehilite"><pre><span></span><code>  <span class="nv">t</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">solution</span> <span class="nv">was</span> <span class="nv">successfully</span> <span class="nv">advanced</span> <span class="nv">to</span> <span class="nv">the</span>
         <span class="nv">output</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">t</span>.

  <span class="nv">y</span><span class="ss">(</span><span class="o">*</span><span class="ss">)</span> <span class="o">--</span> <span class="nv">contains</span> <span class="nv">the</span> <span class="nv">computed</span> <span class="nv">solution</span> <span class="nv">approximation</span> <span class="nv">at</span> <span class="nv">t</span>.
         <span class="nv">you</span> <span class="nv">may</span> <span class="nv">also</span> <span class="nv">be</span> <span class="nv">interested</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">approximate</span> <span class="nv">derivative</span>
         <span class="nv">of</span> <span class="nv">the</span> <span class="nv">solution</span> <span class="nv">at</span> <span class="nv">t</span>.  <span class="nv">it</span> <span class="nv">is</span> <span class="nv">contained</span> <span class="nv">in</span> <span class="nv">me</span><span class="o">%</span><span class="nv">ypout</span>.

  <span class="nv">idid</span> <span class="o">--</span> <span class="nv">reports</span> <span class="nv">what</span> <span class="nv">the</span> <span class="nv">code</span> <span class="nv">did</span>

                     <span class="o">***</span> <span class="nv">task</span> <span class="nv">completed</span> <span class="o">***</span>
               <span class="nv">reported</span> <span class="nv">by</span> <span class="nv">positive</span> <span class="nv">values</span> <span class="nv">of</span> <span class="nv">idid</span>

         <span class="nv">idid</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">--</span> <span class="nv">a</span> <span class="nv">step</span> <span class="nv">was</span> <span class="nv">successfully</span> <span class="nv">taken</span> <span class="nv">in</span> <span class="nv">the</span>
                   <span class="nv">intermediate</span><span class="o">-</span><span class="nv">output</span> <span class="nv">mode</span>.  <span class="nv">the</span> <span class="nv">code</span> <span class="nv">has</span> <span class="nv">not</span>
                   <span class="nv">yet</span> <span class="nv">reached</span> <span class="nv">tout</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">integration</span> <span class="nv">to</span> <span class="nv">tout</span> <span class="nv">was</span> <span class="nv">successfully</span>
                   <span class="nv">completed</span> <span class="ss">(</span><span class="nv">t</span><span class="o">=</span><span class="nv">tout</span><span class="ss">)</span> <span class="nv">by</span> <span class="nv">stepping</span> <span class="nv">exactly</span> <span class="nv">to</span> <span class="nv">tout</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">integration</span> <span class="nv">to</span> <span class="nv">tout</span> <span class="nv">was</span> <span class="nv">successfully</span>
                   <span class="nv">completed</span> <span class="ss">(</span><span class="nv">t</span><span class="o">=</span><span class="nv">tout</span><span class="ss">)</span> <span class="nv">by</span> <span class="nv">stepping</span> <span class="nv">past</span> <span class="nv">tout</span>.
                   <span class="nv">y</span><span class="ss">(</span><span class="o">*</span><span class="ss">)</span> <span class="nv">is</span> <span class="nv">obtained</span> <span class="nv">by</span> <span class="nv">interpolation</span>.

                     <span class="o">***</span> <span class="nv">task</span> <span class="nv">interrupted</span> <span class="o">***</span>
               <span class="nv">reported</span> <span class="nv">by</span> <span class="nv">negative</span> <span class="nv">values</span> <span class="nv">of</span> <span class="nv">idid</span>

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">--</span> <span class="nv">a</span> <span class="nv">large</span> <span class="nv">amount</span> <span class="nv">of</span> <span class="nv">work</span> <span class="nv">has</span> <span class="nv">been</span> <span class="nv">expended</span>.
                   <span class="ss">(</span><span class="nv">maxnum</span> <span class="nv">steps</span> <span class="nv">attempted</span><span class="ss">)</span>

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">error</span> <span class="nv">tolerances</span> <span class="nv">are</span> <span class="nv">too</span> <span class="nv">stringent</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">local</span> <span class="nv">error</span> <span class="nv">test</span> <span class="nv">cannot</span> <span class="nv">be</span> <span class="nv">satisfied</span>
                   <span class="nv">because</span> <span class="nv">you</span> <span class="nv">specified</span> <span class="nv">a</span> <span class="nv">zero</span> <span class="nv">component</span> <span class="nv">in</span> <span class="nv">atol</span>
                   <span class="nv">and</span> <span class="nv">the</span> <span class="nv">corresponding</span> <span class="nv">computed</span> <span class="nv">solution</span>
                   <span class="nv">component</span> <span class="nv">is</span> <span class="nv">zero</span>.  <span class="nv">thus</span>, <span class="nv">a</span> <span class="nv">pure</span> <span class="nv">relative</span> <span class="nv">error</span>
                   <span class="nv">test</span> <span class="nv">is</span> <span class="nv">impossible</span> <span class="k">for</span> <span class="nv">this</span> <span class="nv">component</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">problem</span> <span class="nv">appears</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">stiff</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">5</span>,<span class="o">-</span><span class="mi">6</span>,<span class="o">-</span><span class="mi">7</span>,..,<span class="o">-</span><span class="mi">32</span>  <span class="o">--</span> <span class="nv">not</span> <span class="nv">applicable</span> <span class="k">for</span> <span class="nv">this</span> <span class="nv">code</span>
                   <span class="nv">but</span> <span class="nv">used</span> <span class="nv">by</span> <span class="nv">other</span> <span class="nv">members</span> <span class="nv">of</span> <span class="nv">depac</span> <span class="nv">or</span> <span class="nv">possible</span>
                   <span class="nv">future</span> <span class="nv">extensions</span>.

                     <span class="o">***</span> <span class="nv">task</span> <span class="nv">terminated</span> <span class="o">***</span>
               <span class="nv">reported</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">value</span> <span class="nv">of</span> <span class="nv">idid</span><span class="o">=-</span><span class="mi">33</span>

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span> <span class="o">--</span> <span class="nv">the</span> <span class="nv">code</span> <span class="nv">has</span> <span class="nv">encountered</span> <span class="nv">trouble</span> <span class="nv">from</span> <span class="nv">which</span>
                   <span class="nv">it</span> <span class="nv">cannot</span> <span class="nv">recover</span>.  <span class="nv">a</span> <span class="nv">message</span> <span class="nv">is</span> <span class="nv">printed</span>
                   <span class="nv">explaining</span> <span class="nv">the</span> <span class="nv">trouble</span> <span class="nv">and</span> <span class="nv">control</span> <span class="nv">is</span> <span class="nv">returned</span>
                   <span class="nv">to</span> <span class="nv">the</span> <span class="nv">calling</span> <span class="nv">program</span>. <span class="k">for</span> <span class="nv">example</span>, <span class="nv">this</span> <span class="nv">occurs</span>
                   <span class="nv">when</span> <span class="nv">invalid</span> <span class="nv">input</span> <span class="nv">is</span> <span class="nv">detected</span>.

  <span class="nv">rtol</span>, <span class="nv">atol</span> <span class="o">--</span> <span class="nv">these</span> <span class="nv">quantities</span> <span class="nv">remain</span> <span class="nv">unchanged</span> <span class="nv">except</span> <span class="nv">when</span>
         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>.  <span class="nv">in</span> <span class="nv">this</span> <span class="nv">case</span>, <span class="nv">the</span> <span class="nv">error</span> <span class="nv">tolerances</span> <span class="nv">have</span> <span class="nv">been</span>
         <span class="nv">increased</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">code</span> <span class="nv">to</span> <span class="nv">values</span> <span class="nv">which</span> <span class="nv">are</span> <span class="nv">estimated</span> <span class="nv">to</span> <span class="nv">be</span>
         <span class="nv">appropriate</span> <span class="k">for</span> <span class="nv">continuing</span> <span class="nv">the</span> <span class="nv">integration</span>.  <span class="nv">however</span>, <span class="nv">the</span>
         <span class="nv">reported</span> <span class="nv">solution</span> <span class="nv">at</span> <span class="nv">t</span> <span class="nv">was</span> <span class="nv">obtained</span> <span class="nv">using</span> <span class="nv">the</span> <span class="nv">input</span> <span class="nv">values</span>
         <span class="nv">of</span> <span class="nv">rtol</span> <span class="nv">and</span> <span class="nv">atol</span>.
</code></pre></div>

<h3>input -- what to do to continue the integration (calls after the first)</h3>
<p>this code is organized so that subsequent calls to continue the
  integration involve little (if any) additional effort on your
  part. you must monitor the <code>idid</code> parameter in order to determine
  what to do next.</p>
<p>recalling that the principal task of the code is to integrate
  from <code>t</code> to <code>tout</code> (the interval mode), usually all you will need
  to do is specify a new <code>tout</code> upon reaching the current <code>tout</code>.</p>
<p>do not alter any quantity not specifically permitted below,
  in particular do not alter <code>neq</code>, <code>t</code>, <code>y(*)</code>, the internal work variables
  or the differential equation in subroutine <code>df</code>. any such alteration
  constitutes a new problem and must be treated as such, i.e.
  you must start afresh.</p>
<p>you cannot change from vector to scalar error control or vice
  versa (<code>info(2)</code>) but you can change the size of the entries of
  <code>rtol</code>, <code>atol</code>.  increasing a tolerance makes the equation easier
  to integrate.  decreasing a tolerance will make the equation
  harder to integrate and should generally be avoided.</p>
<p>you can switch from the intermediate-output mode to the
  interval mode (<code>info(3)</code>) or vice versa at any time.</p>
<p>if it has been necessary to prevent the integration from going
  past a point tstop (<code>info(4)</code>), keep in mind that the
  code will not integrate to any <code>tout</code> beyond the currently
  specified <code>tstop</code>.  once <code>tstop</code> has been reached you must change
  the value of <code>tstop</code> or set <code>info(4)=0</code>.  you may change <code>info(4)</code>
  or <code>tstop</code> at any time but you must supply the value of <code>tstop</code>
  whenever you set <code>info(4)=1</code>.</p>
<p>the parameter <code>info(1)</code> is used by the code to indicate the
  beginning of a new problem and to indicate whether integration
  is to be continued.  you must input the value <code>info(1)=0</code>
  when starting a new problem.  you must input the value
  <code>info(1)=1</code> if you wish to continue after an interrupted task.
  do not set <code>info(1)=0</code> on a continuation call unless you
  want the code to restart at the current <code>t</code>.</p>
<div class="codehilite"><pre><span></span><code>                     <span class="o">***</span> <span class="nv">following</span> <span class="nv">a</span> <span class="nv">completed</span> <span class="nv">task</span> <span class="o">***</span>
     <span class="k">if</span>
         <span class="nv">idid</span> <span class="o">=</span> <span class="mi">1</span>, <span class="k">call</span> <span class="nl">the</span> <span class="nv">code</span> <span class="nv">again</span> <span class="nv">to</span> <span class="k">continue</span> <span class="nv">the</span> <span class="nv">integration</span>
                 <span class="nv">another</span> <span class="nv">step</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">direction</span> <span class="nv">of</span> <span class="nv">tout</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="mi">2</span> <span class="nv">or</span> <span class="mi">3</span>, <span class="nv">define</span> <span class="nv">a</span> <span class="nv">new</span> <span class="nv">tout</span> <span class="nv">and</span> <span class="k">call</span> <span class="nl">the</span> <span class="nv">code</span> <span class="nv">again</span>.
                 <span class="nv">tout</span> <span class="nv">must</span> <span class="nv">be</span> <span class="nv">different</span> <span class="nv">from</span> <span class="nv">t</span>. <span class="nv">you</span> <span class="nv">cannot</span> <span class="nv">change</span>
                 <span class="nv">the</span> <span class="nv">direction</span> <span class="nv">of</span> <span class="nv">integration</span> <span class="nv">without</span> <span class="nv">restarting</span>.

                     <span class="o">***</span> <span class="nv">following</span> <span class="nv">an</span> <span class="nv">interrupted</span> <span class="nv">task</span> <span class="o">***</span>
                 <span class="nv">to</span> <span class="k">show</span> <span class="nv">the</span> <span class="nv">code</span> <span class="nv">that</span> <span class="nv">you</span> <span class="nv">realize</span> <span class="nv">the</span> <span class="nv">task</span> <span class="nv">was</span>
                 <span class="nv">interrupted</span> <span class="nv">and</span> <span class="nv">that</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="k">continue</span>, <span class="nv">you</span>
                 <span class="nv">must</span> <span class="nv">take</span> <span class="nv">appropriate</span> <span class="nv">action</span> <span class="nv">and</span> <span class="nv">reset</span> <span class="nv">info</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> <span class="o">=</span> <span class="mi">1</span>
     <span class="k">if</span>
         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>, <span class="nv">the</span> <span class="nv">code</span> <span class="nv">has</span> <span class="nv">attempted</span> <span class="nv">maxnum</span> <span class="nv">steps</span>.
                 <span class="k">if</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="k">continue</span>, <span class="nv">set</span> <span class="nv">info</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span> <span class="o">=</span> <span class="mi">1</span> <span class="nv">and</span>
                 <span class="k">call</span> <span class="nl">the</span> <span class="nv">code</span> <span class="nv">again</span>. <span class="nv">an</span> <span class="nv">additional</span> <span class="nv">maxnum</span> <span class="nv">steps</span>
                 <span class="nv">will</span> <span class="nv">be</span> <span class="nv">allowed</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>, <span class="nv">the</span> <span class="nv">error</span> <span class="nv">tolerances</span> <span class="nv">rtol</span>, <span class="nv">atol</span> <span class="nv">have</span> <span class="nv">been</span>
                 <span class="nv">increased</span> <span class="nv">to</span> <span class="nv">values</span> <span class="nv">the</span> <span class="nv">code</span> <span class="nv">estimates</span> <span class="nv">appropriate</span>
                 <span class="k">for</span> <span class="nv">continuing</span>.  <span class="nv">you</span> <span class="nv">may</span> <span class="nv">want</span> <span class="nv">to</span> <span class="nv">change</span> <span class="nv">them</span>
                 <span class="nv">yourself</span>.  <span class="k">if</span> <span class="nv">you</span> <span class="nv">are</span> <span class="nv">sure</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="k">continue</span>
                 <span class="nv">with</span> <span class="nv">relaxed</span> <span class="nv">error</span> <span class="nv">tolerances</span>, <span class="nv">set</span> <span class="nv">info</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span> <span class="nv">and</span>
                 <span class="k">call</span> <span class="nl">the</span> <span class="nv">code</span> <span class="nv">again</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>, <span class="nv">a</span> <span class="nv">solution</span> <span class="nv">component</span> <span class="nv">is</span> <span class="nv">zero</span> <span class="nv">and</span> <span class="nv">you</span> <span class="nv">set</span> <span class="nv">the</span>
                 <span class="nv">corresponding</span> <span class="nv">component</span> <span class="nv">of</span> <span class="nv">atol</span> <span class="nv">to</span> <span class="nv">zero</span>.  <span class="k">if</span> <span class="nv">you</span>
                 <span class="nv">are</span> <span class="nv">sure</span> <span class="nv">you</span> <span class="nv">want</span> <span class="nv">to</span> <span class="k">continue</span>, <span class="nv">you</span> <span class="nv">must</span> <span class="nv">first</span>
                 <span class="nv">alter</span> <span class="nv">the</span> <span class="nv">error</span> <span class="nv">criterion</span> <span class="nv">to</span> <span class="nv">use</span> <span class="nv">positive</span> <span class="nv">values</span>
                 <span class="k">for</span> <span class="nv">those</span> <span class="nv">components</span> <span class="nv">of</span> <span class="nv">atol</span> <span class="nv">corresponding</span> <span class="nv">to</span> <span class="nv">zero</span>
                 <span class="nv">solution</span> <span class="nv">components</span>, <span class="k">then</span> <span class="nv">set</span> <span class="nv">info</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span> <span class="nv">and</span> <span class="nv">call</span>
                 <span class="nv">the</span> <span class="nv">code</span> <span class="nv">again</span>.

         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span>, <span class="nv">the</span> <span class="nv">problem</span> <span class="nv">appears</span> <span class="nv">to</span> <span class="nv">be</span> <span class="nv">stiff</span>.  <span class="nv">it</span> <span class="nv">is</span> <span class="nv">very</span>
                 <span class="nv">inefficient</span> <span class="nv">to</span> <span class="nv">solve</span> <span class="nv">such</span> <span class="nv">problems</span> <span class="nv">with</span> <span class="nv">ddeabm</span>.
                 <span class="nv">the</span> <span class="nv">code</span> <span class="nv">ddebdf</span> <span class="nv">in</span> <span class="nv">depac</span> <span class="nv">handles</span> <span class="nv">this</span> <span class="nv">task</span>
                 <span class="nv">efficiently</span>.  <span class="k">if</span> <span class="nv">you</span> <span class="nv">are</span> <span class="nv">absolutely</span> <span class="nv">sure</span> <span class="nv">you</span> <span class="nv">want</span>
                 <span class="nv">to</span> <span class="k">continue</span> <span class="nv">with</span> <span class="nv">ddeabm</span>, <span class="nv">set</span> <span class="nv">info</span><span class="ss">(</span><span class="mi">1</span><span class="ss">)</span><span class="o">=</span><span class="mi">1</span> <span class="nv">and</span> <span class="nv">call</span>
                 <span class="nv">the</span> <span class="nv">code</span> <span class="nv">again</span>.

                     <span class="o">***</span> <span class="nv">following</span> <span class="nv">a</span> <span class="nv">terminated</span> <span class="nv">task</span> <span class="o">***</span>
     <span class="k">if</span>
         <span class="nv">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span>, <span class="nv">you</span> <span class="nv">cannot</span> <span class="k">continue</span> <span class="nv">the</span> <span class="nv">solution</span> <span class="nv">of</span> <span class="nv">this</span>
                 <span class="nv">problem</span>.  <span class="nv">an</span> <span class="nv">attempt</span> <span class="nv">to</span> <span class="k">do</span> <span class="nv">so</span> <span class="nv">will</span> <span class="nb">result</span> <span class="nv">in</span> <span class="nv">your</span>
                 <span class="nv">run</span> <span class="nv">being</span> <span class="nv">terminated</span>.
</code></pre></div>

<h3>Authors</h3>
<ul>
<li>L. F. Shampine</li>
<li>H. A. Watts</li>
<li>M. K. Gordon</li>
</ul>
<h3>Reference</h3>
<ul>
<li>L. F. Shampine, H. A. Watts, "DEPAC - Design of a user oriented
     package of ode solvers", Report SAND79-2374, Sandia Laboratories, 1979.</li>
</ul>
<h3>History</h3>
<ul>
<li>820301  date written</li>
<li>890531  changed all specific intrinsics to generic.  (wrb)</li>
<li>890831  modified array declarations.  (wrb)</li>
<li>891006  cosmetic changes to prologue.  (wrb)</li>
<li>891024  changed references from dvnorm to dhvnrm.  (wrb)</li>
<li>891024  revision date from version 3.2</li>
<li>891214  prologue converted to version 4.0 format.  (bab)</li>
<li>900510  convert xerrwv calls to xermsg calls.  (rwc)</li>
<li>920501  reformatted the references section.  (wrb)</li>
<li>July, 2014 : Major refactoring into modern Fortran (jw)</li>
<li>December, 2015 : Additional refactoring (jw)</li>
</ul>
    

    <h3>Arguments</h3>
    
      
<table class="table table-striped varlist">
<thead><tr><th>Type</th>
<th>Intent</th><th>Optional</th>
<th>Attributes</th><th></th><th>Name</th><th></th></thead>



<tbody>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-me~17"></span>class(<a href='../type/ddeabm_class.html'>ddeabm_class</a>),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>me</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-neq~5"></span>integer,</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>neq</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-t~9"></span>real(kind=wp),</td>
  <td>intent(inout)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>t</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-y~4"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(neq)</td><td>::</td>
  <td><strong>y</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-tout~2"></span>real(kind=wp),</td>
  <td>intent(in)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>tout</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-info~2"></span>integer,</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(4)</td><td>::</td>
  <td><strong>info</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-rtol~5"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>rtol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-atol~5"></span>real(kind=wp),</td>
  <td>intent(inout),</td>
  <td></td>
  
  <td>dimension(:)</td><td>::</td>
  <td><strong>atol</strong></td><td></td>
  
</tr>

  
  
  
  
<tr>
  
  <td><span class="anchor" id="variable-idid~4"></span>integer,</td>
  <td>intent(out)</td>
  <td></td>
  
  <td></td><td>::</td>
  <td><strong>idid</strong></td><td></td>
  
</tr>

</tbody>
</table>

    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~ddeabm~~CallsGraph Pages: 1 -->
<svg id="procddeabmCallsGraph" width="177pt" height="32pt"
 viewBox="0.00 0.00 177.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~ddeabm~~CallsGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~ddeabm~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 173,-28 173,4 -4,4"/>
<!-- proc~ddeabm -->
<g id="proc~~ddeabm~~CallsGraph_node1" class="node">
<title>proc~ddeabm</title>
<polygon fill="none" stroke="black" points="57,-24 0,-24 0,0 57,0 57,-24"/>
<text text-anchor="middle" x="28.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">ddeabm</text>
</g>
<!-- proc~report_error -->
<g id="proc~~ddeabm~~CallsGraph_node2" class="node">
<title>proc~report_error</title>
<g id="a_proc~~ddeabm~~CallsGraph_node2"><a xlink:href=".././proc/report_error.html" xlink:title="report_error">
<polygon fill="#d9534f" stroke="#d9534f" points="169,-24 93,-24 93,0 169,0 169,-24"/>
<text text-anchor="middle" x="131" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">report_error</text>
</a>
</g>
</g>
<!-- proc~ddeabm&#45;&gt;proc~report_error -->
<g id="proc~~ddeabm~~CallsGraph_edge1" class="edge">
<title>proc~ddeabm&#45;&gt;proc~report_error</title>
<path fill="none" stroke="#000000" d="M57.23,-12C65.16,-12 74.04,-12 82.8,-12"/>
<polygon fill="#000000" stroke="#000000" points="82.95,-15.5 92.95,-12 82.95,-8.5 82.95,-15.5"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="597pt" height="32pt"
 viewBox="0.00 0.00 596.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 592.5,-28 592.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="388.5,-24 243.5,-24 243.5,0 388.5,0 388.5,-24"/>
<text text-anchor="middle" x="316" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-24 407,-24 407,0 465,0 465,-24"/>
<text text-anchor="middle" x="436" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="588.5,-24 483.5,-24 483.5,0 588.5,0 588.5,-24"/>
<text text-anchor="middle" x="536" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/ddeabm.html#src">ddeabm</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>    <span class="k">subroutine </span><span class="n">ddeabm</span> <span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">neq</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">rtol</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">idid</span><span class="p">)</span>

    <span class="k">implicit none</span>

<span class="k">    class</span><span class="p">(</span><span class="n">ddeabm_class</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>     <span class="kd">::</span> <span class="n">me</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                    <span class="kd">::</span> <span class="n">neq</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>                <span class="kd">::</span> <span class="n">t</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(</span><span class="n">neq</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">y</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">tout</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">dimension</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>    <span class="kd">::</span> <span class="n">info</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">rtol</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">dimension</span><span class="p">(:),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span>   <span class="kd">::</span> <span class="n">atol</span>
    <span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>                   <span class="kd">::</span> <span class="n">idid</span>

    <span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> <span class="kd">::</span> <span class="n">xern3</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">error</span><span class="p">)</span> <span class="k">return</span>  <span class="c">! if user-triggered error</span>

    <span class="c">! check for an apparent infinite loop</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">info</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<span class="k">        if</span> <span class="p">(</span><span class="n">t</span> <span class="o">==</span> <span class="n">me</span><span class="p">%</span><span class="n">tprev</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            write</span> <span class="p">(</span><span class="n">xern3</span><span class="p">,</span> <span class="s1">&#39;(1pe15.6)&#39;</span><span class="p">)</span> <span class="n">t</span>
            <span class="k">call </span><span class="n">report_error</span><span class="p">(</span><span class="s1">&#39;ddeabm&#39;</span><span class="p">,&amp;</span>
                            <span class="s1">&#39;an apparent infinite loop has been detected.  &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;you have made repeated calls at t = &#39;</span> <span class="o">//</span> <span class="n">xern3</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39; and the integration has not advanced.  check the &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;way you have set parameters for the call to the &#39;</span> <span class="o">//</span><span class="p">&amp;</span>
                            <span class="s1">&#39;code, particularly info(1).&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">idid</span> <span class="o">=</span> <span class="o">-</span><span class="mi">33</span>
            <span class="k">return</span>
<span class="k">        end if</span>
<span class="k">    end if</span>

    <span class="c">!make sure the deriv function was set:</span>
    <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="nb">associated</span><span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">df</span><span class="p">))</span> <span class="k">then</span>
<span class="k">        call </span><span class="n">report_error</span><span class="p">(</span><span class="s1">&#39;ddeabm&#39;</span><span class="p">,</span> <span class="s1">&#39;the derivative function DF &#39;</span><span class="o">//</span><span class="p">&amp;</span>
                        <span class="s1">&#39; has not been associated.&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">idid</span><span class="o">=-</span><span class="mi">33</span>
        <span class="k">return</span>
<span class="k">    end if</span>

<span class="k">    </span><span class="n">me</span><span class="p">%</span><span class="n">tprev</span> <span class="o">=</span> <span class="n">t</span>

    <span class="k">call </span><span class="n">me</span><span class="p">%</span><span class="n">ddes</span><span class="p">(</span><span class="n">neq</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">tout</span><span class="p">,</span><span class="n">info</span><span class="p">,</span><span class="n">rtol</span><span class="p">,</span><span class="n">atol</span><span class="p">,</span><span class="n">idid</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">ypout</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">yp</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">yy</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">wt</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">p</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">phi</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">alpha</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">beta</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">psi</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">v</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">w</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">sig</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">g</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">gi</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">h</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">eps</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">x</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">xold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">hold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">told</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">delsgn</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">tstop</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">twou</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">fouru</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">start</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">phase1</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">nornd</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">stiff</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">intout</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ns</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kord</span><span class="p">,</span> <span class="p">&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">kold</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">init</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ksteps</span><span class="p">,&amp;</span>
                    <span class="n">me</span><span class="p">%</span><span class="n">kle4</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">iquit</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kprev</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">ivc</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">iv</span><span class="p">,</span> <span class="n">me</span><span class="p">%</span><span class="n">kgi</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">me</span><span class="p">%</span><span class="n">error</span><span class="p">)</span> <span class="k">return</span> <span class="c">! user-triggered error</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">idid</span> <span class="o">/=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">))</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">t</span> <span class="o">/=</span> <span class="n">me</span><span class="p">%</span><span class="n">tprev</span><span class="p">)</span> <span class="n">me</span><span class="p">%</span><span class="n">icount</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">end subroutine </span><span class="n">ddeabm</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> ddeabm was developed by Jacob Williams</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>